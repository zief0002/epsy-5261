<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>public.csv</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="public_files/libs/clipboard/clipboard.min.js"></script>
<script src="public_files/libs/quarto-html/quarto.js"></script>
<script src="public_files/libs/quarto-html/popper.min.js"></script>
<script src="public_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="public_files/libs/quarto-html/anchor.min.js"></script>
<link href="public_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="public_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="public_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="public_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="public_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="public_files/libs/htmltools-fill/fill.css" rel="stylesheet">
<script src="public_files/libs/htmlwidgets/htmlwidgets.js"></script>
<link href="public_files/libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="public_files/libs/datatables-binding/datatables.js"></script>
<script src="public_files/libs/jquery/jquery-3.6.0.min.js"></script>
<link href="public_files/libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="public_files/libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="public_files/libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="public_files/libs/crosstalk/css/crosstalk.min.css" rel="stylesheet">
<script src="public_files/libs/crosstalk/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">public.csv</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The U.S. Department of Education (DOE) collects and publishes data on institutions of higher education in their <a href="https://collegescorecard.ed.gov/">College Scorecard</a>. The data provided in the College Scorecard facilitate transparency and provide information for interested stakeholders (e.g., parents, students, educators).</p>
<p>The data in <a href="https://raw.githubusercontent.com/zief0002/epsy-5261/main/data/public.csv">public.csv</a> are the <span class="math inline">\(N=71\)</span> public institutions from the original 230 randomly sampled institutions drawn from the 2020â€“21 data (see <a href="https://zief0002.github.io/epsy-5261/codebooks/college-scorecard.html">here</a>).</p>
<hr>
<p>The attributes included in the data are:</p>
<ul>
<li><code>name</code>: Name of institution of higher education</li>
<li><code>state</code>: Two-letter U.S. state abbreviation indicating the location of the institution</li>
<li><code>region</code>: Region of the U.S. in which the institution is located</li>
<li><code>inst_type</code>: Type of institution (Two-year undergraduate, Four-year undergraduate, Exclusively graduate/professional)</li>
<li><code>control</code>: Institutional control (Private, Public)</li>
<li><code>for_profit</code>: Is the institution a for-profit institution? (No, Yes)</li>
<li><code>adm_rate</code>: Admission rate indicating proportion of students who applied that are admitted to the institution</li>
<li><code>undergrads</code>: Number of enrolled undergraduate certificate/degree-seeking students at the institution</li>
<li><code>mdn_debt</code>: Median amount of debt after graduation for undergraduate borrowers who complete their degree</li>
<li><code>mdn_earn</code>: Median earnings of students working and not enrolled 10 years after entry</li>
</ul>
<hr>
<section id="preview" class="level3">
<h3 class="anchored" data-anchor-id="preview">Preview</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>public_colleges <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/epsy-5261/main/data/public.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>public_colleges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c1707d42afbfb1218bcc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c1707d42afbfb1218bcc">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71"],["Abraham Baldwin Agricultural College","Ball State University","Binghamton University","California State University-Chico","California State University-Monterey Bay","California State University-San Marcos","Central Connecticut State University","Central State University","Clemson University","Colorado State University-Fort Collins","CUNY City College","CUNY Lehman College","Dutchess BOCES-Practical Nursing Program","Eastern Michigan University","Eastern New Mexico University-Main Campus","Fort Lewis College","Frostburg State University","Henderson State University","Illinois State University","Indiana State University","Kennesaw State University","Lamar University","Madison Oneida BOCES-Practical Nursing Program","Mansfield University of Pennsylvania","Marion Military Institute","McNeese State University","Miami University-Oxford","Millersville University of Pennsylvania","New Jersey Institute of Technology","New Mexico State University-Main Campus","Radford University","Rhode Island College","Sam Houston State University","San Francisco State University","Shepherd University","Southeast Missouri State University","Southeastern Oklahoma State University","Southern Connecticut State University","Southern Illinois University-Edwardsville","Southwestern Oklahoma State University","Stony Brook University","SUNY College at Geneseo","SUNY College at Old Westbury","SUNY College of Technology at Alfred","Temple University","Tennessee Technological University","Texas A &amp; M University-Kingsville","Texas Tech University","The Evergreen State College","The University of Alabama","The University of Texas at Arlington","The University of Texas at El Paso","University of Alaska Fairbanks","University of Alaska Southeast","University of Baltimore","University of Connecticut-Hartford Campus","University of Florida","University of Hawaii-West Oahu","University of Maine at Farmington","University of Massachusetts-Amherst","University of Minnesota-Duluth","University of Missouri-Kansas City","University of Nebraska-Lincoln","University of North Carolina at Chapel Hill","University of North Florida","University of Oklahoma-Norman Campus","University of Wisconsin-River Falls","University of Wisconsin-Stevens Point","Utah State University","Western Kentucky University","Western Michigan University"],["GA","IN","NY","CA","CA","CA","CT","OH","SC","CO","NY","NY","NY","MI","NM","CO","MD","AR","IL","IN","GA","TX","NY","PA","AL","LA","OH","PA","NJ","NM","VA","RI","TX","CA","WV","MO","OK","CT","IL","OK","NY","NY","NY","NY","PA","TN","TX","TX","WA","AL","TX","TX","AK","AK","MD","CT","FL","HI","ME","MA","MN","MO","NE","NC","FL","OK","WI","WI","UT","KY","MI"],["Southeast","Great Lakes","Mid East","Far West","Far West","Far West","New England","Great Lakes","Southeast","Rocky Mountains","Mid East","Mid East","Mid East","Great Lakes","Southwest","Rocky Mountains","Mid East","Southeast","Great Lakes","Great Lakes","Southeast","Southwest","Mid East","Mid East","Southeast","Southeast","Great Lakes","Mid East","Mid East","Southwest","Southeast","New England","Southwest","Far West","Southeast","Plains","Southwest","New England","Great Lakes","Southwest","Mid East","Mid East","Mid East","Mid East","Mid East","Southeast","Southwest","Southwest","Far West","Southeast","Southwest","Southwest","Far West","Far West","Mid East","New England","Southeast","Far West","New England","New England","Plains","Plains","Plains","Southeast","Southeast","Southwest","Great Lakes","Great Lakes","Rocky Mountains","Southeast","Great Lakes"],["Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate",null,"Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate",null,"Four-year undergraduate","Two-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate",null,"Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate","Four-year undergraduate"],["Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public","Public"],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],[0.7599,0.8705000000000001,0.4303,0.9016999999999999,0.8562,0.7942,0.6485,0.5804,0.6194,0.8352000000000001,0.5054,0.4701,0.8,0.7518,0.506,0.9151,0.7361,0.749,0.8131,0.9229000000000001,0.8310999999999999,0.8268,0.875,0.9602000000000001,0.575,0.633,0.9195,0.8455,0.6603,0.6267,0.7868000000000001,0.8127,0.925,0.8409,0.977,0.9333,0.7859,0.7968,0.8505,0.9320000000000001,0.4891,0.6136,0.5308,0.7171999999999999,0.7141999999999999,0.7963,0.8792,0.7003,0.9838,0.8038999999999999,0.8774999999999999,0.9997,0.6701,0.6352,0.7993,0.9616,0.3113,0.9523,0.9461000000000001,0.6532,0.7855,0.6301,0.7774,0.25,0.7992,0.8338,0.7685,0.8653999999999999,0.9104,0.9775,0.8494],[3546,15171,14300,15689,6456,15016,8402,4009,20796,23332,11967,12087,81,13148,3129,3205,3749,2603,17955,8897,36284,8220,25,1614,400,5825,16418,6314,8311,11107,7267,5892,18811,23411,2479,7659,3078,7239,9892,3834,17962,4820,4543,3651,26969,8564,5114,32412,2053,30610,34726,21070,4259,1063,1856,1659,34237,2755,1509,23884,8351,7077,20128,19261,14308,21087,5238,7258,21087,13086,15706],[17500,23250,18750,16931,13750,17134,22000,31000,21500,20500,12348,10812,6425,25000,16000,18013,22250,18933,20000,23457,24000,21119,8633,25990,12000,22534,23522,24194,21500,18464,23249,21002,22020,15369,21170,21614,17513,21500,20935,16156,18750,20047,15250,15000,24499,16144,23250,22000,19089,23072,18166,18460,19582,20000,22956,21500,15580,15453,24499,23149,22514,18751,21362,14500,16331,20718,20500,22140,14429,22500,26000],[32130,45934,72980,56270,53190,54811,52515,31922,63857,54983,55741,51661,52370,46112,33395,38083,49230,39020,55457,42877,51792,44159,34239,42931,48920,42965,54650,48420,80043,36683,50383,49249,50125,60126,45723,39874,41698,51551,51671,43079,66678,56241,50921,48256,56800,43326,47368,58435,40782,52751,54633,44770,43728,40727,58128,72460,64463,48268,35051,62048,54750,52279,52360,61915,49338,57071,47441,45855,50432,39268,49652]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>state<\/th>\n      <th>region<\/th>\n      <th>inst_type<\/th>\n      <th>control<\/th>\n      <th>for_profit<\/th>\n      <th>adm_rate<\/th>\n      <th>undergrads<\/th>\n      <th>mdn_debt<\/th>\n      <th>mdn_earn<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"name","targets":1},{"name":"state","targets":2},{"name":"region","targets":3},{"name":"inst_type","targets":4},{"name":"control","targets":5},{"name":"for_profit","targets":6},{"name":"adm_rate","targets":7},{"name":"undergrads","targets":8},{"name":"mdn_debt","targets":9},{"name":"mdn_earn","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<p>U.S. Department of Education. (2023). <a href="https://collegescorecard.ed.gov/">College Scorecard data</a>.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>